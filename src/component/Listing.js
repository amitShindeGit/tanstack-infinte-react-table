import React, { useMemo } from "react";
import TanstackDataTable from "./TanstackDataTable";

export default function Listing() {
  // dummy data copied from here: https://codesandbox.io/s/tanstack-table-example-virtualized-infinite-scrolling-1nnk56
  const data = [
    {
      id: 1,
      firstName: "Janice",
      lastName: "Murray",
      age: 14,
      visits: 752,
      progress: 72,
      createdAt: "2024-04-14T16:09:38.950Z",
      status: "relationship",
    },
    {
      id: 2,
      firstName: "Jettie",
      lastName: "Goodwin",
      age: 39,
      visits: 246,
      progress: 83,
      createdAt: "2023-08-05T19:22:00.576Z",
      status: "single",
    },
    {
      id: 3,
      firstName: "America",
      lastName: "Nienow",
      age: 12,
      visits: 193,
      progress: 82,
      createdAt: "2023-12-26T07:23:33.103Z",
      status: "single",
    },
    {
      id: 4,
      firstName: "Odie",
      lastName: "Howell",
      age: 35,
      visits: 50,
      progress: 42,
      createdAt: "2023-08-02T06:47:47.246Z",
      status: "complicated",
    },
    {
      id: 5,
      firstName: "Annamarie",
      lastName: "Langworth",
      age: 3,
      visits: 310,
      progress: 29,
      createdAt: "2024-03-16T04:26:23.454Z",
      status: "complicated",
    },
    {
      id: 6,
      firstName: "Francis",
      lastName: "Cormier",
      age: 19,
      visits: 50,
      progress: 88,
      createdAt: "2023-10-11T05:41:16.292Z",
      status: "single",
    },
    {
      id: 7,
      firstName: "Carolanne",
      lastName: "Hackett",
      age: 9,
      visits: 687,
      progress: 45,
      createdAt: "2024-07-05T00:56:15.953Z",
      status: "relationship",
    },
    {
      id: 8,
      firstName: "Audie",
      lastName: "Lueilwitz",
      age: 21,
      visits: 31,
      progress: 44,
      createdAt: "2023-05-24T00:17:02.891Z",
      status: "relationship",
    },
    {
      id: 9,
      firstName: "Tony",
      lastName: "Bernhard",
      age: 6,
      visits: 175,
      progress: 12,
      createdAt: "2024-11-26T07:17:37.951Z",
      status: "complicated",
    },
    {
      id: 10,
      firstName: "Tierra",
      lastName: "Hilpert",
      age: 34,
      visits: 214,
      progress: 79,
      createdAt: "2023-06-08T22:14:58.237Z",
      status: "relationship",
    },
    {
      id: 11,
      firstName: "Davin",
      lastName: "Sporer",
      age: 20,
      visits: 265,
      progress: 51,
      createdAt: "2024-08-09T01:28:47.227Z",
      status: "complicated",
    },
    {
      id: 12,
      firstName: "Aurore",
      lastName: "Gleichner",
      age: 36,
      visits: 735,
      progress: 17,
      createdAt: "2024-05-08T18:36:20.987Z",
      status: "single",
    },
    {
      id: 13,
      firstName: "Wilfredo",
      lastName: "Boyer",
      age: 15,
      visits: 325,
      progress: 69,
      createdAt: "2024-10-19T09:19:12.009Z",
      status: "complicated",
    },
    {
      id: 14,
      firstName: "Autumn",
      lastName: "Beier",
      age: 24,
      visits: 400,
      progress: 55,
      createdAt: "2024-01-05T01:34:32.137Z",
      status: "complicated",
    },
    {
      id: 15,
      firstName: "Hellen",
      lastName: "Bernier",
      age: 4,
      visits: 721,
      progress: 34,
      createdAt: "2023-11-15T01:47:12.150Z",
      status: "complicated",
    },
    {
      id: 16,
      firstName: "Shawna",
      lastName: "Mertz",
      age: 21,
      visits: 179,
      progress: 79,
      createdAt: "2023-08-06T10:02:57.370Z",
      status: "relationship",
    },
    {
      id: 17,
      firstName: "Simone",
      lastName: "Olson",
      age: 7,
      visits: 835,
      progress: 72,
      createdAt: "2024-01-22T18:38:41.954Z",
      status: "complicated",
    },
    {
      id: 18,
      firstName: "Octavia",
      lastName: "Erdman",
      age: 26,
      visits: 732,
      progress: 46,
      createdAt: "2023-12-07T03:32:05.087Z",
      status: "complicated",
    },
    {
      id: 19,
      firstName: "Letha",
      lastName: "Gibson",
      age: 3,
      visits: 478,
      progress: 20,
      createdAt: "2025-01-28T21:59:50.783Z",
      status: "single",
    },
    {
      id: 20,
      firstName: "Corine",
      lastName: "Ortiz",
      age: 33,
      visits: 66,
      progress: 97,
      createdAt: "2023-10-08T12:06:29.405Z",
      status: "single",
    },
    {
      id: 21,
      firstName: "Carlee",
      lastName: "Funk",
      age: 38,
      visits: 255,
      progress: 49,
      createdAt: "2024-09-14T06:41:08.838Z",
      status: "relationship",
    },
    {
      id: 22,
      firstName: "Madyson",
      lastName: "Witting",
      age: 15,
      visits: 843,
      progress: 79,
      createdAt: "2024-05-13T03:37:57.040Z",
      status: "relationship",
    },
    {
      id: 23,
      firstName: "Sheridan",
      lastName: "Zemlak",
      age: 30,
      visits: 290,
      progress: 35,
      createdAt: "2024-11-27T15:40:18.303Z",
      status: "complicated",
    },
    {
      id: 24,
      firstName: "Angie",
      lastName: "Schultz",
      age: 17,
      visits: 609,
      progress: 32,
      createdAt: "2024-09-26T15:27:56.945Z",
      status: "relationship",
    },
    {
      id: 25,
      firstName: "Cheyanne",
      lastName: "Gutmann",
      age: 38,
      visits: 509,
      progress: 51,
      createdAt: "2023-09-21T23:58:03.326Z",
      status: "relationship",
    },
    {
      id: 26,
      firstName: "Lauriane",
      lastName: "Gulgowski-Ferry",
      age: 33,
      visits: 573,
      progress: 37,
      createdAt: "2024-07-07T04:58:43.423Z",
      status: "complicated",
    },
    {
      id: 27,
      firstName: "Linda",
      lastName: "Kessler",
      age: 3,
      visits: 235,
      progress: 57,
      createdAt: "2023-09-17T10:12:43.548Z",
      status: "single",
    },
    {
      id: 28,
      firstName: "Darby",
      lastName: "Schulist",
      age: 32,
      visits: 119,
      progress: 5,
      createdAt: "2023-02-18T13:26:43.586Z",
      status: "complicated",
    },
    {
      id: 29,
      firstName: "Faye",
      lastName: "Bailey",
      age: 8,
      visits: 561,
      progress: 75,
      createdAt: "2024-01-01T11:03:38.189Z",
      status: "single",
    },
    {
      id: 30,
      firstName: "Andy",
      lastName: "Kuvalis",
      age: 12,
      visits: 239,
      progress: 35,
      createdAt: "2024-06-25T00:11:23.976Z",
      status: "complicated",
    },
    {
      id: 31,
      firstName: "Albina",
      lastName: "Schulist",
      age: 14,
      visits: 633,
      progress: 75,
      createdAt: "2023-07-10T09:27:29.364Z",
      status: "relationship",
    },
    {
      id: 32,
      firstName: "Natalia",
      lastName: "Sanford",
      age: 28,
      visits: 784,
      progress: 100,
      createdAt: "2023-12-31T18:58:07.870Z",
      status: "single",
    },
    {
      id: 33,
      firstName: "Pauline",
      lastName: "Roob",
      age: 23,
      visits: 311,
      progress: 33,
      createdAt: "2023-04-01T18:42:02.519Z",
      status: "single",
    },
    {
      id: 34,
      firstName: "Rosario",
      lastName: "Rath",
      age: 39,
      visits: 327,
      progress: 75,
      createdAt: "2024-08-30T21:46:53.595Z",
      status: "relationship",
    },
    {
      id: 35,
      firstName: "Oma",
      lastName: "Gerlach",
      age: 5,
      visits: 835,
      progress: 100,
      createdAt: "2023-11-04T18:15:55.412Z",
      status: "single",
    },
    {
      id: 36,
      firstName: "Camila",
      lastName: "Wiza",
      age: 5,
      visits: 593,
      progress: 68,
      createdAt: "2023-11-25T18:12:32.366Z",
      status: "complicated",
    },
    {
      id: 37,
      firstName: "Presley",
      lastName: "Steuber",
      age: 19,
      visits: 147,
      progress: 68,
      createdAt: "2023-08-13T17:19:17.282Z",
      status: "single",
    },
    {
      id: 38,
      firstName: "Tracey",
      lastName: "Kessler",
      age: 28,
      visits: 377,
      progress: 60,
      createdAt: "2023-05-03T16:51:54.080Z",
      status: "single",
    },
    {
      id: 39,
      firstName: "Kira",
      lastName: "Kuhlman",
      age: 35,
      visits: 172,
      progress: 66,
      createdAt: "2024-10-27T04:24:41.454Z",
      status: "relationship",
    },
    {
      id: 40,
      firstName: "Major",
      lastName: "Haag",
      age: 14,
      visits: 603,
      progress: 89,
      createdAt: "2024-08-02T18:19:47.386Z",
      status: "relationship",
    },
    {
      id: 41,
      firstName: "Grant",
      lastName: "Welch",
      age: 31,
      visits: 646,
      progress: 18,
      createdAt: "2024-06-04T01:17:03.469Z",
      status: "complicated",
    },
    {
      id: 42,
      firstName: "Lawrence",
      lastName: "Parker",
      age: 6,
      visits: 217,
      progress: 35,
      createdAt: "2023-04-20T13:26:26.310Z",
      status: "single",
    },
    {
      id: 43,
      firstName: "Lesly",
      lastName: "Parisian",
      age: 27,
      visits: 793,
      progress: 47,
      createdAt: "2024-06-10T08:14:54.257Z",
      status: "relationship",
    },
    {
      id: 44,
      firstName: "Jason",
      lastName: "Larkin",
      age: 11,
      visits: 836,
      progress: 48,
      createdAt: "2024-08-23T17:32:22.109Z",
      status: "relationship",
    },
    {
      id: 45,
      firstName: "Frederic",
      lastName: "Dietrich",
      age: 40,
      visits: 62,
      progress: 55,
      createdAt: "2024-02-17T20:40:30.021Z",
      status: "single",
    },
    {
      id: 46,
      firstName: "Reynold",
      lastName: "Smitham",
      age: 24,
      visits: 327,
      progress: 76,
      createdAt: "2023-06-20T02:14:14.748Z",
      status: "relationship",
    },
    {
      id: 47,
      firstName: "Trinity",
      lastName: "Stanton",
      age: 39,
      visits: 745,
      progress: 66,
      createdAt: "2024-02-24T01:59:45.257Z",
      status: "relationship",
    },
    {
      id: 48,
      firstName: "Caterina",
      lastName: "Bogan",
      age: 39,
      visits: 886,
      progress: 85,
      createdAt: "2024-12-02T01:46:39.356Z",
      status: "relationship",
    },
    {
      id: 49,
      firstName: "Selena",
      lastName: "Hermann",
      age: 3,
      visits: 377,
      progress: 32,
      createdAt: "2024-07-24T15:59:36.860Z",
      status: "single",
    },
    {
      id: 50,
      firstName: "Brycen",
      lastName: "Breitenberg",
      age: 7,
      visits: 336,
      progress: 73,
      createdAt: "2024-12-20T08:31:57.665Z",
      status: "complicated",
    },
  ];
  const columns = useMemo(
    () => [
      {
        accessorKey: "id",
        header: "ID",
        size: 60,
      },
      {
        accessorKey: "firstName",
        cell: (info) => info.getValue(),
      },
      {
        accessorFn: (row) => row.lastName,
        id: "lastName",
        cell: (info) => info.getValue(),
        header: () => <span>Last Name</span>,
      },
      {
        accessorKey: "age",
        header: () => "Age",
        size: 50,
      },
      {
        accessorKey: "visits",
        header: () => <span>Visits</span>,
        size: 50,
      },
      {
        accessorKey: "status",
        header: "Status",
      },
      {
        accessorKey: "progress",
        header: "Profile Progress",
        size: 80,
      },
      {
        accessorKey: "createdAt",
        header: "Created At",
        cell: (info) => info.getValue().toLocaleString(),
        size: 200,
      },
    ],
    []
  );

  const fetchData = async (start, size, sorting) => {
    const dbData = [...data];
    if (sorting.length) {
      const sort = sorting[0];
      const { id, desc } = sort;
      dbData.sort((a, b) => {
        if (desc) {
          return a[id] < b[id] ? 1 : -1;
        }
        return a[id] > b[id] ? 1 : -1;
      });
    }

    return {
      data: dbData.slice(start, start + size),
      meta: {
        totalRowCount: dbData.length,
      },
    };
  };

  return (
    <div style={{ border: "1px solid black" }}>
      <TanstackDataTable
        columnData={columns}
        fetchData={fetchData}
        fetchSize={20}
        queryKey="unique_key_here"
        rowModel="infinite"
        height="450px"
      />
    </div>
  );
}
